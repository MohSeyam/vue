import{d as K,a as z,i as O,r as p,c as S,q as R,e as f,o as s,b as l,w as t,f as n,h as c,t as u,B as G,_ as H,C as N,j as J,k as L,F as A,g as P}from"./index-D8FjZVCZ.js";import{T as Q}from"./TipTapEditor-D_V2bewF.js";const M=K("journal",{state:()=>({entries:[],tags:[]}),actions:{addEntry(d){const r={...d,id:crypto.randomUUID(),createdAt:new Date().toISOString()};this.entries.push(r)},getJournalsByDayKey(d){return this.entries.filter(r=>r.dayKey===d)}}}),W=z({__name:"JournalEntry",props:{entry:Object},emits:["save","close"],setup(d,{emit:r}){const{locale:y}=O(),b=d,i=r,g=M(),V=p(!0),m=p(""),w=p([]),C=S(()=>y.value==="ar"),T=S(()=>Array.from(new Set(g.entries.flatMap(e=>e.tags||[]))));R(()=>b.entry,e=>{e&&(m.value=e.content||"",w.value=e.tags||[])},{immediate:!0});function I(){i("save",{...b.entry,content:m.value,tags:w.value}),V.value=!1}function h(){i("close"),V.value=!1}return(e,o)=>{const k=l("v-card-title"),v=l("v-combobox"),x=l("v-card-text"),E=l("v-btn"),j=l("v-card-actions"),D=l("v-form"),U=l("v-card"),B=l("v-dialog");return s(),f(B,{modelValue:V.value,"onUpdate:modelValue":o[2]||(o[2]=_=>V.value=_),"max-width":"700"},{default:t(()=>[n(U,null,{default:t(()=>[n(k,{class:"font-weight-bold text-primary"},{default:t(()=>[c(u(d.entry&&d.entry.id?e.$t("journal.editEntry"):e.$t("journal.addEntry")),1)]),_:1}),n(D,{onSubmit:G(I,["prevent"])},{default:t(()=>[n(x,null,{default:t(()=>[n(Q,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=_=>m.value=_),rtl:C.value},null,8,["modelValue","rtl"]),n(v,{modelValue:w.value,"onUpdate:modelValue":o[1]||(o[1]=_=>w.value=_),items:T.value,label:e.$t("journal.tags"),multiple:"",chips:"",clearable:"",class:"mb-2"},null,8,["modelValue","items","label"])]),_:1}),n(j,{class:"justify-end"},{default:t(()=>[n(E,{text:"",onClick:h},{default:t(()=>[c(u(e.$t("journal.cancel","إلغاء")),1)]),_:1}),n(E,{color:"primary",type:"submit"},{default:t(()=>[c(u(e.$t("journal.save","حفظ")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),X=H(W,[["__scopeId","data-v-b37de75d"]]),Y={class:"d-flex flex-wrap gap-1 mb-2"},te=z({__name:"JournalView",setup(d){const r=M(),y=p(!1),b=p(),i=p(""),g=p(""),V=S(()=>Array.from(new Set(r.entries.flatMap(e=>e.tags||[])))),m=S(()=>{let e=r.entries;if(g.value&&(e=e.filter(o=>o.tags?.includes(g.value))),i.value){const o=i.value.toLowerCase();e=e.filter(k=>k.content.toLowerCase().includes(o))}return e});function w(e){b.value=e,y.value=!0}function C(){y.value=!1,b.value=void 0}function T(e){r.addEntry(e),C()}function I(){}function h(e){return new Date(e).toLocaleDateString()}return(e,o)=>{const k=l("v-text-field"),v=l("v-col"),x=l("v-btn"),E=l("v-row"),j=l("v-chip"),D=l("v-chip-group"),U=l("v-card-title"),B=l("v-card-text"),_=l("v-card"),q=l("v-alert"),F=l("v-container");return s(),f(F,{fluid:"",class:"py-8"},{default:t(()=>[n(E,{class:"mb-4",align:"center"},{default:t(()=>[n(v,{cols:"12",md:"6"},{default:t(()=>[n(k,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=a=>i.value=a),label:e.$t("journal.search"),"prepend-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue","label"])]),_:1}),n(v,{cols:"12",md:"6",class:"text-end"},{default:t(()=>[n(x,{color:"primary","prepend-icon":"mdi-plus",onClick:o[1]||(o[1]=a=>y.value=!0)},{default:t(()=>[c(u(e.$t("journal.addEntry")),1)]),_:1})]),_:1})]),_:1}),n(E,{class:"mb-4"},{default:t(()=>[n(v,{cols:"12"},{default:t(()=>[n(D,{modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=a=>g.value=a),row:""},{default:t(()=>[(s(!0),J(A,null,L(V.value,a=>(s(),f(j,{key:a,value:a,filter:""},{default:t(()=>[c(u(a),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(E,null,{default:t(()=>[(s(!0),J(A,null,L(m.value,a=>(s(),f(v,{key:a.id,cols:"12",sm:"6",md:"4"},{default:t(()=>[n(_,{class:"pa-4 mb-4",elevation:"6"},{default:t(()=>[n(U,{class:"font-weight-bold text-primary"},{default:t(()=>[c(u(h(a.createdAt)),1)]),_:2},1024),n(B,{class:"mb-2"},{default:t(()=>[c(u(a.content.slice(0,120))+"...",1)]),_:2},1024),P("div",Y,[(s(!0),J(A,null,L(a.tags,$=>(s(),f(j,{key:$,size:"x-small",color:"secondary",class:"me-1"},{default:t(()=>[c(u($),1)]),_:2},1024))),128))]),n(x,{color:"primary",icon:"mdi-pencil",onClick:$=>w(a),size:"small",class:"me-2"},null,8,["onClick"]),n(x,{color:"error",icon:"mdi-delete",onClick:o[3]||(o[3]=$=>void 0),size:"small"})]),_:2},1024)]),_:2},1024))),128)),m.value.length===0?(s(),f(v,{key:0,cols:"12"},{default:t(()=>[n(q,{type:"info",color:"primary"},{default:t(()=>[c(u(e.$t("journal.noEntries")),1)]),_:1})]),_:1})):N("",!0)]),_:1}),y.value?(s(),f(X,{key:0,entry:b.value,onSave:T,onClose:C},null,8,["entry"])):N("",!0)]),_:1})}}});export{te as default};
